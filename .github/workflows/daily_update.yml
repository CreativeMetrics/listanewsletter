name: Aggiornamento Newsletter

on:
  schedule:
	- cron: '0 0 * * *'
  workflow_dispatch:

jobs:
  build:
	runs-on: ubuntu-latest
	steps:
	  - name: Checkout
		uses: actions/checkout@v3

	  - name: Setup Python
		uses: actions/setup-python@v4
		with:
		  python-version: '3.9'

	  - name: Install Dependencies
		run: pip install requests

	  - name: Run Script
		env:
		  BREVO_API_KEY: ${{ secrets.BREVO_API_KEY }}
		run: python archivio.py

	  - name: Commit and Push
		run: |
		  git config --global user.name "GitHub Action"
		  git config --global user.email "action@github.com"
		  git add index.html
		  git commit -m "Aggiornamento automatico" || exit 0
		  git push